{"version":3,"file":"index.js","sources":["../src/js/render-functions.js","../src/js/pixabay-api.js","../src/main.js"],"sourcesContent":["export function imagesCardTemplate(images) {\n  return images\n    .map(\n      (image) => `\n      <a href=\"${image.largeImageURL}\" class=\"gallery-item\">\n        <img src=\"${image.webformatURL}\" alt=\"${image.tags}\" loading=\"lazy\" />\n        <div class=\"gallery-info\">\n          <div>\n            <p><b>Likes:</b> ${image.likes}</p>\n            <p><b>Views:</b> ${image.views}</p>\n          </div>\n          <div>\n            <p><b>Comments:</b> ${image.comments}</p>\n            <p><b>Downloads:</b> ${image.downloads}</p>\n          </div>\n        </div>\n      </a>\n    `\n    )\n    .join(\"\");\n}\n","import axios from \"axios\";\n\nconst API_KEY = \"48313222-9e5699caa5ef89de4c12bc71b\";\nconst BASE_URL = \"https://pixabay.com/api/\";\n\nexport async function fetchSearch(query, page) {\n  const response = await axios.get(BASE_URL, {\n    params: {\n      key: API_KEY,\n      q: query,\n      image_type: \"photo\",\n      orientation: \"horizontal\",\n      safesearch: true,\n      per_page: 15,\n      page: page,\n    },\n  });\n  return response.data;\n}\n","import iziToast from \"izitoast\";\r\nimport \"izitoast/dist/css/iziToast.min.css\";\r\nimport SimpleLightbox from \"simplelightbox\";\r\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\r\nimport { imagesCardTemplate } from \"./js/render-functions\";\r\nimport { fetchSearch } from \"./js/pixabay-api\";\r\n\r\nconst form = document.querySelector(\"#search-form\");\r\nconst gallery = document.querySelector(\"#gallery\");\r\nconst loader = document.querySelector(\"#loader\");\r\nconst loadMoreButton = document.querySelector(\"#load-more\");\r\n\r\nlet currentPage = 1;\r\nlet query = \"\";\r\nlet totalPages = 0;\r\nlet totalHits = 0;\r\nlet isLoading = false;\r\n\r\nlet lightbox = new SimpleLightbox(\".gallery a\", {\r\n  captionsData: \"alt\",\r\n  captionDelay: 250,\r\n});\r\n\r\nloadMoreButton.classList.add(\"hidden\");\r\n\r\nform.addEventListener(\"submit\", async (event) => {\r\n  event.preventDefault();\r\n  query = event.target.searchQuery.value.trim();\r\n\r\n  if (!query) {\r\n    iziToast.error({\r\n      title: \"Error\",\r\n      message: \"Please enter a search query!\",\r\n    });\r\n    return;\r\n  }\r\n\r\n  currentPage = 1;\r\n  totalPages = 0;\r\n  totalHits = 0;\r\n  gallery.innerHTML = \"\";\r\n  loadMoreButton.classList.add(\"hidden\"); \r\n\r\n  await fetchAndRenderImages(query, currentPage);\r\n});\r\n\r\nasync function fetchAndRenderImages(query, page) {\r\n  if (isLoading) return;\r\n  isLoading = true;\r\n  showLoader();\r\n\r\n  try {\r\n    const data = await fetchSearch(query, page, 15);\r\n\r\n    if (data.hits.length === 0 && page === 1) {\r\n      iziToast.warning({\r\n        title: \"No Results\",\r\n        message: \"Sorry, there are no images matching your search query. Please try again!\",\r\n      });\r\n      return;\r\n    }\r\n\r\n    totalHits = data.totalHits; \r\n    totalPages = Math.ceil(totalHits / 15);\r\n    renderGallery(data.hits);\r\n\r\n    if (currentPage >= totalPages) {\r\n      loadMoreButton.classList.add(\"hidden\");\r\n      iziToast.info({\r\n        title: \"End of Results\",\r\n        message: \"We're sorry, but you've reached the end of search results.\",\r\n      });\r\n    } else {\r\n      loadMoreButton.classList.remove(\"hidden\");\r\n    }\r\n\r\n  } catch (error) {\r\n    iziToast.error({\r\n      title: \"Error\",\r\n      message: \"Failed to fetch images. Please try again later.\",\r\n    });\r\n  } finally {\r\n    hideLoader();\r\n    isLoading = false;\r\n  }\r\n}\r\n\r\nfunction renderGallery(images) {\r\n  const markup = imagesCardTemplate(images);\r\n  gallery.insertAdjacentHTML(\"beforeend\", markup); \r\n  lightbox.refresh();\r\n}\r\n\r\nfunction smoothScrollToNewContent() {\r\n  const cardHeight = document.querySelector(\".gallery a\").getBoundingClientRect().height;\r\n\r\n  window.scrollBy({\r\n    top: cardHeight * 2,\r\n    behavior: \"smooth\",\r\n  });\r\n}\r\n\r\nloadMoreButton.addEventListener(\"click\", async () => {\r\n  if (currentPage < totalPages) {\r\n    currentPage++;\r\n    await fetchAndRenderImages(query, currentPage);\r\n    smoothScrollToNewContent();\r\n  }\r\n});\r\n\r\nfunction showLoader() {\r\n  loader.classList.remove(\"hidden\");\r\n  loadMoreButton.insertAdjacentElement(\"afterend\", loader);\r\n}\r\n\r\nfunction hideLoader() {\r\n  loader.classList.add(\"hidden\");\r\n}\r\n\r\n\r\n"],"names":["imagesCardTemplate","images","image","API_KEY","BASE_URL","fetchSearch","query","page","axios","form","gallery","loader","loadMoreButton","currentPage","totalPages","totalHits","isLoading","lightbox","SimpleLightbox","event","iziToast","fetchAndRenderImages","showLoader","data","renderGallery","hideLoader","markup","smoothScrollToNewContent","cardHeight"],"mappings":"+vBAAO,SAASA,EAAmBC,EAAQ,CACzC,OAAOA,EACJ,IACEC,GAAU;AAAA,iBACAA,EAAM,aAAa;AAAA,oBAChBA,EAAM,YAAY,UAAUA,EAAM,IAAI;AAAA;AAAA;AAAA,+BAG3BA,EAAM,KAAK;AAAA,+BACXA,EAAM,KAAK;AAAA;AAAA;AAAA,kCAGRA,EAAM,QAAQ;AAAA,mCACbA,EAAM,SAAS;AAAA;AAAA;AAAA;AAAA,KAK7C,EACA,KAAK,EAAE,CACZ,CClBA,MAAMC,EAAU,qCACVC,EAAW,2BAEV,eAAeC,EAAYC,EAAOC,EAAM,CAY7C,OAXiB,MAAMC,EAAM,IAAIJ,EAAU,CACzC,OAAQ,CACN,IAAKD,EACL,EAAGG,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAU,GACV,KAAMC,CACP,CACL,CAAG,GACe,IAClB,CCXA,MAAME,EAAO,SAAS,cAAc,cAAc,EAC5CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAiB,SAAS,cAAc,YAAY,EAE1D,IAAIC,EAAc,EACdP,EAAQ,GACRQ,EAAa,EACbC,EAAY,EACZC,EAAY,GAEZC,EAAW,IAAIC,EAAe,aAAc,CAC9C,aAAc,MACd,aAAc,GAChB,CAAC,EAEDN,EAAe,UAAU,IAAI,QAAQ,EAErCH,EAAK,iBAAiB,SAAU,MAAOU,GAAU,CAI/C,GAHAA,EAAM,eAAc,EACpBb,EAAQa,EAAM,OAAO,YAAY,MAAM,KAAI,EAEvC,CAACb,EAAO,CACVc,EAAS,MAAM,CACb,MAAO,QACP,QAAS,8BACf,CAAK,EACD,MACD,CAEDP,EAAc,EACdC,EAAa,EACbC,EAAY,EACZL,EAAQ,UAAY,GACpBE,EAAe,UAAU,IAAI,QAAQ,EAErC,MAAMS,EAAqBf,EAAOO,CAAW,CAC/C,CAAC,EAED,eAAeQ,EAAqBf,EAAOC,EAAM,CAC/C,GAAI,CAAAS,EACJ,CAAAA,EAAY,GACZM,IAEA,GAAI,CACF,MAAMC,EAAO,MAAMlB,EAAYC,EAAOC,EAAM,EAAE,EAE9C,GAAIgB,EAAK,KAAK,SAAW,GAAKhB,IAAS,EAAG,CACxCa,EAAS,QAAQ,CACf,MAAO,aACP,QAAS,0EACjB,CAAO,EACD,MACD,CAEDL,EAAYQ,EAAK,UACjBT,EAAa,KAAK,KAAKC,EAAY,EAAE,EACrCS,EAAcD,EAAK,IAAI,EAEnBV,GAAeC,GACjBF,EAAe,UAAU,IAAI,QAAQ,EACrCQ,EAAS,KAAK,CACZ,MAAO,iBACP,QAAS,4DACjB,CAAO,GAEDR,EAAe,UAAU,OAAO,QAAQ,CAG3C,MAAe,CACdQ,EAAS,MAAM,CACb,MAAO,QACP,QAAS,iDACf,CAAK,CACL,QAAY,CACRK,IACAT,EAAY,EACb,EACH,CAEA,SAASQ,EAAcvB,EAAQ,CAC7B,MAAMyB,EAAS1B,EAAmBC,CAAM,EACxCS,EAAQ,mBAAmB,YAAagB,CAAM,EAC9CT,EAAS,QAAO,CAClB,CAEA,SAASU,GAA2B,CAClC,MAAMC,EAAa,SAAS,cAAc,YAAY,EAAE,sBAAuB,EAAC,OAEhF,OAAO,SAAS,CACd,IAAKA,EAAa,EAClB,SAAU,QACd,CAAG,CACH,CAEAhB,EAAe,iBAAiB,QAAS,SAAY,CAC/CC,EAAcC,IAChBD,IACA,MAAMQ,EAAqBf,EAAOO,CAAW,EAC7Cc,IAEJ,CAAC,EAED,SAASL,GAAa,CACpBX,EAAO,UAAU,OAAO,QAAQ,EAChCC,EAAe,sBAAsB,WAAYD,CAAM,CACzD,CAEA,SAASc,GAAa,CACpBd,EAAO,UAAU,IAAI,QAAQ,CAC/B"}